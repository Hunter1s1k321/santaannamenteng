========================================
INSTRUKSI SETUP - ABSENSI PD ST ANNA MENTENG
========================================

ğŸ“‹ SPREADSHEET INFO:
ID: 1U6p_iVVOLDdyeHqDBrT3mbMInaASKa5EL2UrfXHw4FQ
Sheet: Absensi PD St Anna Menteng

Kolom di Spreadsheet:
A. Timestamp (otomatis)
B. Nama panggilan
C. Nama Lengkap
D. Tanggal Lahir (opsional)
E. Nomor HP
F. Asal Paroki / Gereja

âš ï¸ CATATAN PENTING:
Script ini MENGGABUNGKAN sistem yang sudah ada:
- Google Form (onFormSubmit) â†’ Tetap jalan seperti biasa
- HTML Form (doPost) â†’ Input alternatif baru
- WhatsApp Notification â†’ Dipakai oleh keduanya

========================================
LANGKAH 1: BACKUP KODE LAMA (PENTING!)
========================================

1. Buka Google Spreadsheet Anda:
   https://docs.google.com/spreadsheets/d/1U6p_iVVOLDdyeHqDBrT3mbMInaASKa5EL2UrfXHw4FQ/edit

2. Klik menu "Extensions" â†’ "Apps Script"

3. COPY semua kode yang ada sekarang â†’ Simpan di Notepad (backup!)

4. Ini penting untuk jaga-jaga kalau ada masalah


========================================
LANGKAH 2: GANTI DENGAN KODE BARU
========================================

1. Masih di Apps Script Editor

2. HAPUS semua kode yang ada

3. COPY SEMUA kode dari file "google-apps-script.js"

4. PASTE ke Apps Script Editor

5. Klik "Save" (ğŸ’¾) atau tekan Ctrl+S

6. Pastikan tidak ada error (lihat di bawah editor)


========================================
LANGKAH 3: DEPLOY WEB APP
========================================

âš ï¸ INI UNTUK HTML FORM SAJA (Google Form tidak perlu deploy ulang)

1. Di Apps Script Editor, klik "Deploy" â†’ "New deployment"

2. Klik icon "gear" (âš™ï¸) â†’ Pilih "Web app"

3. Isi setting berikut:
   - Description: Absensi Form API
   - Execute as: Me (email Anda)
   - Who has access: Anyone
   
4. Klik "Deploy"

5. Akan muncul popup "Authorize access" â†’ Klik "Authorize access"

6. Pilih akun Google Anda

7. Klik "Advanced" â†’ "Go to [Project Name] (unsafe)"

8. Klik "Allow"

9. COPY URL yang muncul! Contoh:
   https://script.google.com/macros/s/AKfycbxxx.../exec
   
   âš ï¸ URL INI SANGAT PENTING! Simpan baik-baik!


========================================
LANGKAH 4: UPDATE FILE HTML
========================================

1. Buka file "index.html"

2. Cari baris ini (sekitar baris 173):
   const SCRIPT_URL = 'GANTI_DENGAN_URL_DEPLOYMENT_ANDA';

3. Ganti dengan URL deployment yang Anda copy tadi:
   const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxxx.../exec';

4. Save file (Ctrl+S)


========================================
LANGKAH 5: TEST SISTEM
========================================

ğŸ” TEST HTML FORM:

1. Buka file "index.html" di browser (double click)

2. Isi form dengan data test

3. Klik "Submit Absensi"

4. Jika berhasil:
   âœ… Muncul pesan "Data berhasil disimpan! Nomor urut: X"
   âœ… Data masuk ke spreadsheet
   âœ… User terima WA otomatis
   âœ… Admin terima WA notifikasi

ğŸ” TEST GOOGLE FORM:

1. Submit data via Google Form yang sudah ada

2. Sistem WhatsApp tetap jalan seperti biasa

3. Tidak ada perubahan di Google Form


========================================
CARA KERJA SISTEM
========================================

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   GOOGLE FORM   â”‚ â”€â”€â†’ onFormSubmit()
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â†“
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â†“
â”‚   HTML FORM     â”‚ â”€â”€â†’ doPost()
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â†“
                           â†“
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚ sendWhatsApp      â”‚
                   â”‚ Notifications()   â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚  1. Save to Sheet â”‚
                   â”‚  2. Send WA User  â”‚
                   â”‚  3. Send WA Admin â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


========================================
FITUR YANG SUDAH TERINTEGRASI
========================================

âœ… Auto WhatsApp ke User dengan nomor urut
âœ… Auto WhatsApp ke Admin (08111928287)
âœ… Format nomor HP otomatis (0812 â†’ 62812)
âœ… Format tanggal lahir Indonesia
âœ… Validasi nomor HP
âœ… Timestamp otomatis
âœ… Nomor urut otomatis
âœ… Support Google Form + HTML Form


========================================
TROUBLESHOOTING
========================================

âŒ Error: "Terjadi kesalahan"
â†’ Pastikan URL deployment sudah benar di index.html
â†’ Pastikan "Who has access" = "Anyone" saat deploy

âŒ WhatsApp tidak terkirim
â†’ Cek TOKEN dan INSTANCE_ID masih valid
â†’ Cek nomor admin di CONFIG.ADMIN_TARGETS
â†’ Lihat log error di Apps Script (View â†’ Execution log)

âŒ Data tidak masuk ke spreadsheet
â†’ Cek nama sheet harus sama persis: "Absensi PD St Anna Menteng"
â†’ Cek Spreadsheet ID di CONFIG

âŒ Form tidak bisa disubmit
â†’ Buka Console browser (F12) â†’ lihat error message
â†’ Pastikan semua field required sudah diisi

âŒ Google Form tidak kirim WA
â†’ Pastikan trigger "onFormSubmit" masih aktif
â†’ Cek di Apps Script: Triggers (icon jam) â†’ Harus ada onFormSubmit


========================================
PENTING! CEK TRIGGER GOOGLE FORM
========================================

Setelah deploy, pastikan trigger Google Form masih aktif:

1. Di Apps Script Editor, klik icon "Triggers" (â°)

2. Harus ada trigger:
   - Function: onFormSubmit
   - Event: From spreadsheet
   - Event type: On form submit

3. Jika tidak ada, TAMBAHKAN:
   - Klik "+ Add Trigger"
   - Choose function: onFormSubmit
   - Select event source: From spreadsheet
   - Select event type: On form submit
   - Klik "Save"


========================================
KONFIGURASI WHATSAPP (Jika Perlu Ubah)
========================================

Di file google-apps-script.js, cari bagian CONFIG:

const CONFIG = {
  SPREADSHEET_ID: '...',
  SHEET_NAME: '...',
  TOKEN: "...",                    â† Token WhatsApp API
  INSTANCE_ID: "...",              â† Instance ID
  ADMIN_TARGETS: ["08111928287"],  â† Nomor admin yang terima notif
  BASE_URL: "..."                  â† API endpoint
};

Untuk menambah admin, tambahkan di array:
ADMIN_TARGETS: ["08111928287", "08123456789", "08999999999"]


========================================
DEPLOY KE WEBSITE HOSTING
========================================

Setelah test berhasil, Anda bisa upload index.html ke:
- GitHub Pages
- Netlify
- Vercel
- Hosting lainnya

File index.html sudah standalone, tidak perlu file lain!


========================================
SUPPORT & TESTING
========================================

Gunakan fungsi testDoPost() untuk testing:

1. Di Apps Script Editor
2. Pilih function: testDoPost
3. Klik "Run"
4. Lihat log: View â†’ Execution log
5. Cek apakah data masuk & WA terkirim

Jika ada masalah, screenshoot:
- Error message
- Execution log
- URL deployment yang digunakan

Selamat menggunakan! ğŸ‰
